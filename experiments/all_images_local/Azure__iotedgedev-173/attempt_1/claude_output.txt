Perfect! The issue has been successfully fixed. Here's a summary of the changes:

## Changes Made

### 1. **iotedgedev/connectionstring.py**
- Added a `HubName` property to the `IoTHubConnectionString` class that extracts the hub name from the HostName (splits on '.' and takes the first part)
- Changed from using `self["key"]` to `self.get("key")` to safely handle missing keys
- Added a `get()` method to the `ConnectionString` base class

### 2. **iotedgedev/azurecli.py**
- Updated the `apply_configuration` method to use the `-n` parameter with `self.envvars.IOTHUB_CONNECTION_INFO.HubName` instead of the connection string

## Verification

All tests pass successfully:
- ✓ HubName property correctly extracted from HostName
- ✓ HubName property works with different hostname formats
- ✓ apply_configuration correctly uses the `-n` parameter with the hub name
- ✓ DeviceConnectionString continues to work correctly

The fix resolves the issue where users with old versions of the Azure CLI IoT extension would get an error about the `--hub-name/-n` parameter being required. Now the hub name is properly extracted from the connection string and passed to the `apply-configuration` command.
=== GIT DIFF ===
diff --git a/iotedgedev/azurecli.py b/iotedgedev/azurecli.py
index c5bce70..e39eada 100644
--- a/iotedgedev/azurecli.py
+++ b/iotedgedev/azurecli.py
@@ -229,7 +229,7 @@ class AzureCli:
     def apply_configuration(self, deviceId, connection_string, config):
         self.output.status(f("Deploying '{config}' to '{deviceId}'..."))
 
-        return self.invoke_az_cli_outproc(["iot", "hub", "apply-configuration", "-d", deviceId, "-k", config, "-l", connection_string], error_message=f("Failed to deploy '{config}' to '{deviceId}'..."), suppress_output=True)
+        return self.invoke_az_cli_outproc(["iot", "hub", "apply-configuration", "-d", deviceId, "-k", config, "-n", self.envvars.IOTHUB_CONNECTION_INFO.HubName], error_message=f("Failed to deploy '{config}' to '{deviceId}'..."), suppress_output=True)
 
     def get_free_iothub(self):
         with output_io_cls() as io:
diff --git a/iotedgedev/connectionstring.py b/iotedgedev/connectionstring.py
index cc29b68..5d9adfa 100644
--- a/iotedgedev/connectionstring.py
+++ b/iotedgedev/connectionstring.py
@@ -3,7 +3,7 @@ class ConnectionString:
         self.value = value
         self.data = dict()
 
-        if self.value: 
+        if self.value:
             parts = value.split(';')
             if len(parts) > 0:
                 for part in parts:
@@ -12,19 +12,24 @@ class ConnectionString:
                         self.data[subpart[0].lower()] = subpart[1].strip()
 
             if self.data:
-                self.HostName = self["hostname"]
-                self.SharedAccessKey = self["sharedaccesskey"]
+                self.HostName = self.get("hostname")
+                self.SharedAccessKey = self.get("sharedaccesskey")
 
     def __getitem__(self, key):
         return self.data[key]
 
+    def get(self, key, default=None):
+        return self.data.get(key, default)
+
 
 class IoTHubConnectionString(ConnectionString):
     def __init__(self, value):
         ConnectionString.__init__(self, value)
 
         if self.value:
-            self.SharedAccessKeyName = self["sharedaccesskeyname"]
+            self.SharedAccessKeyName = self.get("sharedaccesskeyname")
+            if self.HostName:
+                self.HubName = self.HostName.split('.')[0]
 
 
 class DeviceConnectionString(ConnectionString):
=== DISK USAGE ===
92	/testbed
