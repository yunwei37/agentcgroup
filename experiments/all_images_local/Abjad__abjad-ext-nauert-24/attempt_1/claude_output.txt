## Summary

I've successfully fixed the grace note handling issues in the `abjadext.nauert` package. The changes address two problems:

### Issues Fixed:
1. **Grace rest attaching to a pitched note**: Previously, a grace rest (`r16`) was being incorrectly attached to the first `c'4` note when `discard_grace_rest=False`.
2. **Grace note attaching to a rest**: Previously, a grace note (`c'16`) was being incorrectly attached to an `r4` rest.

### Root Cause:
The `ConcatenatingGraceHandler.__call__` method was creating grace containers containing both grace notes and grace rests without checking whether the final note was a pitched note or a rest.

### Changes Made:

**1. Code fix in `/testbed/abjadext/nauert/gracehandlers.py`:**
- Modified the grace event filtering logic to ensure:
  - Grace rests (SilentQEvent) are only included when the final note is a rest
  - Grace notes (PitchedQEvent) are only included when the final note is a pitched note
  - This prevents grace containers from being attached to the wrong type of note

**2. Test updates in `/testbed/tests/test_ConcatenatingGraceHandler___call__.py`:**
- Updated test expectations to reflect the correct behavior
- Added comments explaining the fixes

**3. Docstring updates in `/testbed/abjadext/nauert/gracehandlers.py`:**
- Updated examples to show the correct behavior
- Clarified that grace notes and rests are not attached to incompatible note types

### Verification:
- All 102 tests pass successfully
- The issue examples now produce correct output
- No grace rests are attached to pitched notes
- No grace notes are attached to rests
=== GIT DIFF ===
diff --git a/abjadext/nauert/gracehandlers.py b/abjadext/nauert/gracehandlers.py
index 8813e0f..62580db 100644
--- a/abjadext/nauert/gracehandlers.py
+++ b/abjadext/nauert/gracehandlers.py
@@ -172,7 +172,8 @@ class ConcatenatingGraceHandler(GraceHandler):
     ..  container:: example
 
         When ``discard_grace_rest`` is set to ``False``, grace rests are not
-        discarded.
+        discarded from the grace container. However, grace rests will only be
+        attached when the final note is a rest, not when it's a pitched note.
 
         >>> grace_handler = nauert.ConcatenatingGraceHandler(discard_grace_rest=False)
         >>> result = quantizer(q_event_sequence, grace_handler=grace_handler)
@@ -188,9 +189,6 @@ class ConcatenatingGraceHandler(GraceHandler):
                     \tempo 4=60
                     %%% \time 4/4 %%%
                     c'4
-                    \grace {
-                        r16
-                    }
                     c'4
                     r4
                     r4
@@ -200,7 +198,7 @@ class ConcatenatingGraceHandler(GraceHandler):
     ..  container:: example
 
         When ``replace_rest_with_final_grace_note`` is set to ``False`` (the
-        default behaviour), grace notes are allowed to be attached to a rest.
+        default behaviour), grace notes are NOT attached to rests.
 
         >>> quantizer = nauert.Quantizer()
         >>> durations = [1000, 1, 999, 1000]
@@ -222,9 +220,6 @@ class ConcatenatingGraceHandler(GraceHandler):
                     \tempo 4=60
                     %%% \time 4/4 %%%
                     c'4
-                    \grace {
-                        c'16
-                    }
                     r4
                     c'4
                     r4
@@ -301,10 +296,20 @@ class ConcatenatingGraceHandler(GraceHandler):
             pitches = ()
 
         grace_events_list = list(grace_events)
-        if self._discard_grace_rest:
-            for q_event in grace_events_list:
-                if isinstance(q_event, SilentQEvent):
-                    grace_events_list.remove(q_event)
+        # Only include SilentQEvents (grace rests) when final event is a rest
+        # Grace rests should not be attached to pitched notes
+        if self._discard_grace_rest or not isinstance(final_event, SilentQEvent):
+            grace_events_list = [
+                q_event for q_event in grace_events_list
+                if not isinstance(q_event, SilentQEvent)
+            ]
+        # Only include PitchedQEvents (grace notes) when final event is a pitched note
+        # Grace notes should not be attached to rests
+        if not isinstance(final_event, PitchedQEvent):
+            grace_events_list = [
+                q_event for q_event in grace_events_list
+                if not isinstance(q_event, PitchedQEvent)
+            ]
         grace_events = tuple(grace_events_list)
 
         if grace_events:
diff --git a/tests/test_ConcatenatingGraceHandler___call__.py b/tests/test_ConcatenatingGraceHandler___call__.py
index 75fa793..963bbcc 100644
--- a/tests/test_ConcatenatingGraceHandler___call__.py
+++ b/tests/test_ConcatenatingGraceHandler___call__.py
@@ -29,6 +29,7 @@ def test_ConcatenatingGraceHandler___call___01():
 
 
 def test_ConcatenatingGraceHandler___call___02():
+    # Grace rests should not be attached to pitched notes
     grace_handler = nauert.ConcatenatingGraceHandler(discard_grace_rest=False)
     quantizer = nauert.Quantizer()
     durations = [1000, 1, 999]
@@ -45,9 +46,6 @@ def test_ConcatenatingGraceHandler___call___02():
                 \tempo 4=60
                 %%% \time 4/4 %%%
                 c'4
-                \grace {
-                    r16
-                }
                 c'4
                 r4
                 r4
@@ -58,6 +56,7 @@ def test_ConcatenatingGraceHandler___call___02():
 
 
 def test_ConcatenatingGraceHandler___call___03():
+    # Grace notes should not be attached to rests
     grace_handler = nauert.ConcatenatingGraceHandler()
     quantizer = nauert.Quantizer()
     durations = [1000, 1, 999, 1000]
@@ -74,9 +73,6 @@ def test_ConcatenatingGraceHandler___call___03():
                 \tempo 4=60
                 %%% \time 4/4 %%%
                 c'4
-                \grace {
-                    c'16
-                }
                 r4
                 c'4
                 r4
=== DISK USAGE ===
2	/testbed
